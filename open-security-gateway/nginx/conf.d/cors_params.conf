# CORS Configuration for Wildbox Security Suite
# Handles Cross-Origin Resource Sharing for dashboard integration

# CORS Headers for API endpoints
map $request_method $cors_origin {
    default "";
    OPTIONS $http_origin;
    GET $http_origin;
    POST $http_origin;
    PUT $http_origin;
    DELETE $http_origin;
    PATCH $http_origin;
}

map $request_method $cors_creds {
    default "";
    OPTIONS "true";
    GET "true";
    POST "true";
    PUT "true";
    DELETE "true";
    PATCH "true";
}

map $request_method $cors_methods {
    default "";
    OPTIONS "GET, POST, PUT, DELETE, PATCH, OPTIONS";
    GET "GET, POST, PUT, DELETE, PATCH, OPTIONS";
    POST "GET, POST, PUT, DELETE, PATCH, OPTIONS";
    PUT "GET, POST, PUT, DELETE, PATCH, OPTIONS";
    DELETE "GET, POST, PUT, DELETE, PATCH, OPTIONS";
    PATCH "GET, POST, PUT, DELETE, PATCH, OPTIONS";
}

map $request_method $cors_headers {
    default "";
    OPTIONS "DNT,User-Agent,X-Requested-With,If-Modified-Since,Cache-Control,Content-Type,Range,Authorization,X-API-Key,X-Wildbox-User-ID,X-Wildbox-Team-ID";
    GET "DNT,User-Agent,X-Requested-With,If-Modified-Since,Cache-Control,Content-Type,Range,Authorization,X-API-Key,X-Wildbox-User-ID,X-Wildbox-Team-ID";
    POST "DNT,User-Agent,X-Requested-With,If-Modified-Since,Cache-Control,Content-Type,Range,Authorization,X-API-Key,X-Wildbox-User-ID,X-Wildbox-Team-ID";
    PUT "DNT,User-Agent,X-Requested-With,If-Modified-Since,Cache-Control,Content-Type,Range,Authorization,X-API-Key,X-Wildbox-User-ID,X-Wildbox-Team-ID";
    DELETE "DNT,User-Agent,X-Requested-With,If-Modified-Since,Cache-Control,Content-Type,Range,Authorization,X-API-Key,X-Wildbox-User-ID,X-Wildbox-Team-ID";
    PATCH "DNT,User-Agent,X-Requested-With,If-Modified-Since,Cache-Control,Content-Type,Range,Authorization,X-API-Key,X-Wildbox-User-ID,X-Wildbox-Team-ID";
}
