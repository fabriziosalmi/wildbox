<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="Complete Wildbox API Reference - All endpoints documented with examples">
    <title>Wildbox API Reference</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="icon" href="../wildbox.png">
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&family=JetBrains+Mono:wght@400;600&display=swap');

        body { font-family: 'Inter', sans-serif; }
        code, pre { font-family: 'JetBrains Mono', monospace; }

        .gradient-text {
            background: linear-gradient(135deg, #3b82f6 0%, #2563eb 100%);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }

        .glass-effect {
            background: rgba(59, 130, 246, 0.05);
            backdrop-filter: blur(16px);
            border: 1px solid rgba(59, 130, 246, 0.15);
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
        }

        .glass-effect:hover {
            background: rgba(59, 130, 246, 0.08);
            border-color: rgba(59, 130, 246, 0.3);
        }

        .api-method {
            display: inline-block;
            padding: 0.35rem 0.75rem;
            border-radius: 4px;
            font-weight: 600;
            font-size: 0.85rem;
            font-family: 'JetBrains Mono';
        }

        .method-get { background: rgba(59, 130, 246, 0.2); color: #60a5fa; }
        .method-post { background: rgba(34, 197, 94, 0.2); color: #4ade80; }
        .method-put { background: rgba(248, 113, 113, 0.2); color: #f87171; }
        .method-delete { background: rgba(239, 68, 68, 0.2); color: #fca5a5; }
        .method-patch { background: rgba(245, 158, 11, 0.2); color: #fbbf24; }

        .endpoint-card {
            border-left: 4px solid #3b82f6;
            transition: all 0.3s ease;
        }

        .endpoint-card:hover {
            transform: translateX(4px);
            box-shadow: 0 10px 30px rgba(59, 130, 246, 0.2);
        }

        .code-block {
            background: #0f172a;
            border: 1px solid rgba(59, 130, 246, 0.2);
            border-radius: 8px;
            padding: 1rem;
            overflow-x: auto;
            box-shadow: inset 0 2px 8px rgba(0, 0, 0, 0.4), 0 0 20px rgba(59, 130, 246, 0.1);
        }

        .code-block code {
            color: #e5e7eb;
            font-size: 0.9rem;
            line-height: 1.5;
        }

        .param-table {
            background: rgba(255, 255, 255, 0.02);
            border: 1px solid rgba(255, 255, 255, 0.1);
            border-radius: 6px;
            overflow: hidden;
        }

        .param-table td, .param-table th {
            padding: 0.75rem;
            border-bottom: 1px solid rgba(255, 255, 255, 0.05);
            text-align: left;
            font-size: 0.95rem;
        }

        .param-table th {
            background: rgba(59, 130, 246, 0.1);
            font-weight: 600;
            color: #60a5fa;
        }

        .param-type {
            color: #93c5fd;
            font-family: 'JetBrains Mono';
            font-weight: 500;
            font-size: 0.85rem;
        }

        .required-badge {
            display: inline-block;
            background: #3b82f6;
            color: white;
            padding: 0.2rem 0.5rem;
            border-radius: 3px;
            font-size: 0.75rem;
            font-weight: 600;
            margin-left: 0.5rem;
        }

        .optional-badge {
            display: inline-block;
            background: #6b7280;
            color: white;
            padding: 0.2rem 0.5rem;
            border-radius: 3px;
            font-size: 0.75rem;
            font-weight: 600;
            margin-left: 0.5rem;
        }

        .status-badge {
            display: inline-block;
            padding: 0.3rem 0.7rem;
            border-radius: 4px;
            font-size: 0.85rem;
            font-weight: 600;
        }

        .status-200 { background: rgba(34, 197, 94, 0.2); color: #4ade80; }
        .status-201 { background: rgba(34, 197, 94, 0.2); color: #4ade80; }
        .status-400 { background: rgba(248, 113, 113, 0.2); color: #f87171; }
        .status-401 { background: rgba(239, 68, 68, 0.2); color: #fca5a5; }
        .status-404 { background: rgba(245, 158, 11, 0.2); color: #fbbf24; }
        .status-429 { background: rgba(245, 158, 11, 0.2); color: #fbbf24; }
        .status-500 { background: rgba(239, 68, 68, 0.2); color: #fca5a5; }

        /* Logo styling - invert colors and remove white background */
        .logo-inverted {
            filter: invert(1) brightness(1.2);
            mix-blend-mode: screen;
        }
    </style>
</head>
<body class="bg-black text-white">
    <!-- Navigation -->
    <nav class="sticky top-0 z-50 glass-effect border-b border-blue-900/30">
        <div class="max-w-6xl mx-auto px-4 py-4 flex justify-between items-center">
            <div>
                <a href="index.html" class="flex items-center gap-2 hover:opacity-80 transition">
                    <img src="../wildbox.png" alt="Wildbox Logo" class="w-8 h-8 object-contain logo-inverted">
                    <span class="text-xl font-bold bg-gradient-to-r from-blue-400 to-blue-600 bg-clip-text text-transparent">Wildbox</span>
                </a>
            </div>
            <div class="hidden md:flex gap-6">
                <a href="docs.html" class="text-gray-300 hover:text-white transition">Docs Home</a>
                <a href="api-reference.html" class="text-blue-400 transition">API Reference</a>
                <a href="https://github.com/fabriziosalmi/wildbox" class="text-gray-300 hover:text-white transition">GitHub</a>
            </div>
        </div>
    </nav>

    <!-- Main Content -->
    <main class="max-w-6xl mx-auto px-4 py-12">
        <!-- Header -->
        <div class="mb-16">
            <h1 class="text-5xl font-bold mb-4">
                <span class="gradient-text">API Reference</span>
            </h1>
            <p class="text-xl text-gray-400 mb-8">Complete documentation for all Wildbox microservices and their endpoints.</p>
        </div>

        <!-- Quick Links -->
        <div class="grid md:grid-cols-2 lg:grid-cols-3 gap-4 mb-16">
            <a href="#identity-api" class="glass-effect p-4 rounded-lg hover:bg-blue-950/30 transition transform hover:scale-105">
                <h3 class="font-semibold text-blue-400 mb-2">Identity Service</h3>
                <p class="text-sm text-gray-400">Authentication, users, tokens</p>
            </a>
            <a href="#guardian-api" class="glass-effect p-4 rounded-lg hover:bg-blue-950/30 transition transform hover:scale-105">
                <h3 class="font-semibold text-blue-400 mb-2">Guardian Service</h3>
                <p class="text-sm text-gray-400">Integrations, queue management</p>
            </a>
            <a href="#agents-api" class="glass-effect p-4 rounded-lg hover:bg-blue-950/30 transition transform hover:scale-105">
                <h3 class="font-semibold text-blue-400 mb-2">Agents Service</h3>
                <p class="text-sm text-gray-400">AI analysis, threat intelligence</p>
            </a>
            <a href="#data-api" class="glass-effect p-4 rounded-lg hover:bg-blue-950/30 transition transform hover:scale-105">
                <h3 class="font-semibold text-blue-400 mb-2">Data Service</h3>
                <p class="text-sm text-gray-400">Data aggregation, analysis</p>
            </a>
            <a href="#tools-api" class="glass-effect p-4 rounded-lg hover:bg-blue-950/30 transition transform hover:scale-105">
                <h3 class="font-semibold text-blue-400 mb-2">Tools Service</h3>
                <p class="text-sm text-gray-400">Security tool execution</p>
            </a>
            <a href="#responder-api" class="glass-effect p-4 rounded-lg hover:bg-blue-950/30 transition transform hover:scale-105">
                <h3 class="font-semibold text-blue-400 mb-2">Responder Service</h3>
                <p class="text-sm text-gray-400">Incident response, playbooks</p>
            </a>
        </div>

        <!-- Services Documentation -->
        <div class="space-y-20">
            <!-- Identity Service -->
            <section id="identity-api" class="scroll-mt-20">
                <div class="border-b border-gray-800 pb-8 mb-8">
                    <h2 class="text-3xl font-bold mb-4">Identity & Authentication Service</h2>
                    <div class="flex gap-4 items-start mb-4">
                        <div class="text-gray-400 text-sm max-w-2xl">
                            <p>Manage user authentication, create and validate JWT tokens, handle user accounts and permissions.</p>
                            <p class="mt-2 text-xs text-gray-500">Base URL: <code class="bg-gray-800 px-2 py-1 rounded">http://localhost:8000/api/v1</code></p>
                        </div>
                    </div>
                    <div class="flex gap-3">
                        <a href="https://github.com/fabriziosalmi/wildbox/blob/main/docs/api/identity/endpoints.md" target="_blank" class="inline-block px-4 py-2 bg-blue-600 hover:bg-blue-700 rounded text-sm transition">
                            View Full Documentation
                        </a>
                        <a href="http://localhost:8000/docs" target="_blank" class="inline-block px-4 py-2 border border-blue-600 hover:border-blue-400 rounded text-sm transition">
                            Swagger UI
                        </a>
                        <a href="http://localhost:8000/openapi.json" target="_blank" class="inline-block px-4 py-2 border border-gray-600 hover:border-gray-400 rounded text-sm transition">
                            OpenAPI Schema
                        </a>
                    </div>
                </div>

                <!-- Core Endpoints -->
                <div class="space-y-6">
                    <div class="endpoint-card glass-effect p-6 rounded-lg">
                        <div class="flex items-start justify-between mb-3">
                            <div>
                                <span class="api-method method-post">POST</span>
                                <code class="ml-2 text-gray-300">/auth/login</code>
                            </div>
                        </div>
                        <p class="text-gray-400 mb-4">User login with email and password. Returns JWT token for authenticated requests.</p>
                        <details class="cursor-pointer">
                            <summary class="text-sm text-blue-400 hover:text-blue-300 font-semibold">View Request/Response</summary>
                            <div class="mt-4 space-y-4">
                                <div>
                                    <h5 class="text-sm font-semibold mb-2">Request Body</h5>
                                    <div class="code-block">
                                        <code>{
  "email": "user@example.com",
  "password": "password123"
}</code>
                                    </div>
                                </div>
                                <div>
                                    <h5 class="text-sm font-semibold mb-2"><span class="status-badge status-200">200 OK</span></h5>
                                    <div class="code-block">
                                        <code>{
  "data": {
    "token": "eyJhbGciOiJIUzI1NiIs...",
    "user_id": "usr-123",
    "expires_in": 3600
  },
  "status": "success"
}</code>
                                    </div>
                                </div>
                            </div>
                        </details>
                    </div>

                    <div class="endpoint-card glass-effect p-6 rounded-lg">
                        <div class="flex items-start justify-between mb-3">
                            <div>
                                <span class="api-method method-post">POST</span>
                                <code class="ml-2 text-gray-300">/auth/refresh</code>
                            </div>
                        </div>
                        <p class="text-gray-400 mb-4">Refresh an existing JWT token to extend the session duration.</p>
                    </div>

                    <div class="endpoint-card glass-effect p-6 rounded-lg">
                        <div class="flex items-start justify-between mb-3">
                            <div>
                                <span class="api-method method-post">POST</span>
                                <code class="ml-2 text-gray-300">/auth/logout</code>
                            </div>
                        </div>
                        <p class="text-gray-400 mb-4">Logout user and revoke the current JWT token.</p>
                    </div>

                    <div class="endpoint-card glass-effect p-6 rounded-lg">
                        <div class="flex items-start justify-between mb-3">
                            <div>
                                <span class="api-method method-get">GET</span>
                                <code class="ml-2 text-gray-300">/users</code>
                            </div>
                        </div>
                        <p class="text-gray-400 mb-4">List all users with pagination and filtering support.</p>
                    </div>

                    <div class="endpoint-card glass-effect p-6 rounded-lg">
                        <div class="flex items-start justify-between mb-3">
                            <div>
                                <span class="api-method method-post">POST</span>
                                <code class="ml-2 text-gray-300">/users</code>
                            </div>
                        </div>
                        <p class="text-gray-400 mb-4">Create a new user account with specified permissions.</p>
                    </div>

                    <div class="endpoint-card glass-effect p-6 rounded-lg">
                        <div class="flex items-start justify-between mb-3">
                            <div>
                                <span class="api-method method-get">GET</span>
                                <code class="ml-2 text-gray-300">/users/{id}</code>
                            </div>
                        </div>
                        <p class="text-gray-400 mb-4">Retrieve detailed information about a specific user.</p>
                    </div>

                    <div class="endpoint-card glass-effect p-6 rounded-lg">
                        <div class="flex items-start justify-between mb-3">
                            <div>
                                <span class="api-method method-put">PUT</span>
                                <code class="ml-2 text-gray-300">/users/{id}</code>
                            </div>
                        </div>
                        <p class="text-gray-400 mb-4">Update user profile, permissions, and settings.</p>
                    </div>

                    <div class="endpoint-card glass-effect p-6 rounded-lg">
                        <div class="flex items-start justify-between mb-3">
                            <div>
                                <span class="api-method method-delete">DELETE</span>
                                <code class="ml-2 text-gray-300">/users/{id}</code>
                            </div>
                        </div>
                        <p class="text-gray-400 mb-4">Delete a user account and revoke all associated tokens.</p>
                    </div>
                </div>
            </section>

            <!-- Guardian Service Endpoints -->
            <section id="guardian-api" class="scroll-mt-20">
                <h2 class="text-3xl font-bold mb-6">Guardian Service API</h2>
                <p class="text-gray-400 mb-8">Asset management, vulnerability tracking, scanner orchestration, and remediation workflows</p>

                <!-- Assets Endpoints -->
                <div class="mb-8">
                    <h3 class="text-xl font-semibold mb-4 text-blue-400">Assets Management</h3>
                    <div class="space-y-4">
                        <!-- GET /assets -->
                        <div class="glass-effect p-6 rounded-lg endpoint-card">
                            <div class="flex items-start justify-between mb-3">
                                <div>
                                    <h4 class="font-semibold">List Assets</h4>
                                    <p class="text-sm text-gray-400">GET /api/v1/assets/</p>
                                </div>
                                <span class="api-method method-get">GET</span>
                            </div>
                            <p class="text-gray-400 mb-3">List all security assets with filtering and pagination support.</p>
                            <details class="group">
                                <summary class="cursor-pointer text-sm text-blue-400 hover:text-blue-300">View Details</summary>
                                <div class="mt-3 pt-3 border-t border-gray-700 text-sm text-gray-300">
                                    <p class="mb-2"><strong>Query Parameters:</strong></p>
                                    <ul class="list-disc list-inside text-xs mb-3 text-gray-400 space-y-1">
                                        <li>limit: Number of results (default: 20)</li>
                                        <li>offset: Pagination offset (default: 0)</li>
                                        <li>status: Filter by status (active, inactive, vulnerable)</li>
                                        <li>severity: Highest vulnerability (critical, high, medium, low)</li>
                                    </ul>
                                    <p class="mb-1"><strong>Example:</strong></p>
                                    <div class="code-block text-xs"><code>curl "http://localhost:8001/api/v1/assets/?status=active&severity=critical" \
  -H "X-API-Key: your-api-key"</code></div>
                                </div>
                            </details>
                        </div>

                        <!-- POST /assets -->
                        <div class="glass-effect p-6 rounded-lg endpoint-card">
                            <div class="flex items-start justify-between mb-3">
                                <div>
                                    <h4 class="font-semibold">Create Asset</h4>
                                    <p class="text-sm text-gray-400">POST /api/v1/assets/</p>
                                </div>
                                <span class="api-method method-post">POST</span>
                            </div>
                            <p class="text-gray-400 mb-3">Create a new security asset in the system.</p>
                            <details class="group">
                                <summary class="cursor-pointer text-sm text-blue-400 hover:text-blue-300">View Details</summary>
                                <div class="mt-3 pt-3 border-t border-gray-700 text-sm text-gray-300">
                                    <p class="mb-2"><strong>Request Body Fields:</strong></p>
                                    <ul class="list-disc list-inside text-xs mb-3 text-gray-400 space-y-1">
                                        <li>name: Asset name (required)</li>
                                        <li>asset_type: Type like server, database (required)</li>
                                        <li>ip_address: IPv4 or IPv6 address</li>
                                        <li>hostname: FQDN or hostname</li>
                                        <li>tags: Array of tags for organization</li>
                                    </ul>
                                    <p class="mb-1"><strong>Example:</strong></p>
                                    <div class="code-block text-xs"><code>curl -X POST "http://localhost:8001/api/v1/assets/" \
  -H "X-API-Key: your-api-key" \
  -H "Content-Type: application/json" \
  -d '{"name":"Web Server","asset_type":"server","ip_address":"192.168.1.100"}'</code></div>
                                </div>
                            </details>
                        </div>

                        <!-- POST /assets/{id}/scan -->
                        <div class="glass-effect p-6 rounded-lg endpoint-card">
                            <div class="flex items-start justify-between mb-3">
                                <div>
                                    <h4 class="font-semibold">Scan Asset</h4>
                                    <p class="text-sm text-gray-400">POST /api/v1/assets/{id}/scan/</p>
                                </div>
                                <span class="api-method method-post">POST</span>
                            </div>
                            <p class="text-gray-400 mb-3">Initiate a security scan on an asset.</p>
                            <details class="group">
                                <summary class="cursor-pointer text-sm text-blue-400 hover:text-blue-300">View Details</summary>
                                <div class="mt-3 pt-3 border-t border-gray-700 text-sm text-gray-300">
                                    <p class="mb-2"><strong>Request Parameters:</strong></p>
                                    <ul class="list-disc list-inside text-xs mb-3 text-gray-400 space-y-1">
                                        <li>scanner_id: Scanner to use (required)</li>
                                        <li>scan_profile: full, quick, vulnerability-only</li>
                                        <li>schedule: immediate, daily, weekly</li>
                                    </ul>
                                    <p class="mb-1"><strong>Example:</strong></p>
                                    <div class="code-block text-xs"><code>curl -X POST "http://localhost:8001/api/v1/assets/asset-001/scan/" \
  -H "X-API-Key: your-api-key" \
  -H "Content-Type: application/json" \
  -d '{"scanner_id":"scanner-nessus-01","scan_profile":"full"}'</code></div>
                                </div>
                            </details>
                        </div>
                    </div>
                </div>

                <!-- Vulnerabilities Endpoints -->
                <div class="mb-8">
                    <h3 class="text-xl font-semibold mb-4 text-blue-400">Vulnerabilities Management</h3>
                    <div class="space-y-4">
                        <!-- GET /vulnerabilities -->
                        <div class="glass-effect p-6 rounded-lg endpoint-card">
                            <div class="flex items-start justify-between mb-3">
                                <div>
                                    <h4 class="font-semibold">List Vulnerabilities</h4>
                                    <p class="text-sm text-gray-400">GET /api/v1/vulnerabilities/</p>
                                </div>
                                <span class="api-method method-get">GET</span>
                            </div>
                            <p class="text-gray-400 mb-3">List all vulnerabilities with advanced filtering capabilities.</p>
                            <details class="group">
                                <summary class="cursor-pointer text-sm text-blue-400 hover:text-blue-300">View Details</summary>
                                <div class="mt-3 pt-3 border-t border-gray-700 text-sm text-gray-300">
                                    <p class="mb-2"><strong>Query Parameters:</strong></p>
                                    <ul class="list-disc list-inside text-xs mb-3 text-gray-400 space-y-1">
                                        <li>severity: critical, high, medium, low, info</li>
                                        <li>status: open, in_progress, resolved, false_positive</li>
                                        <li>asset_id: Filter by specific asset</li>
                                        <li>has_exploit: Filter by known exploits</li>
                                    </ul>
                                    <p class="mb-1"><strong>Example:</strong></p>
                                    <div class="code-block text-xs"><code>curl "http://localhost:8001/api/v1/vulnerabilities/?severity=critical&status=open" \
  -H "X-API-Key: your-api-key"</code></div>
                                </div>
                            </details>
                        </div>

                        <!-- PATCH /vulnerabilities/{id} -->
                        <div class="glass-effect p-6 rounded-lg endpoint-card">
                            <div class="flex items-start justify-between mb-3">
                                <div>
                                    <h4 class="font-semibold">Update Vulnerability</h4>
                                    <p class="text-sm text-gray-400">PATCH /api/v1/vulnerabilities/{id}/</p>
                                </div>
                                <span class="api-method method-patch">PATCH</span>
                            </div>
                            <p class="text-gray-400 mb-3">Update vulnerability status or assignment.</p>
                            <details class="group">
                                <summary class="cursor-pointer text-sm text-blue-400 hover:text-blue-300">View Details</summary>
                                <div class="mt-3 pt-3 border-t border-gray-700 text-sm text-gray-300">
                                    <p class="mb-2"><strong>Request Fields:</strong></p>
                                    <ul class="list-disc list-inside text-xs mb-3 text-gray-400 space-y-1">
                                        <li>status: open, in_progress, resolved, false_positive</li>
                                        <li>assigned_to: Team or user assignment</li>
                                        <li>priority: immediate, high, medium, low</li>
                                        <li>remediation_notes: Remediation details</li>
                                    </ul>
                                    <p class="mb-1"><strong>Example:</strong></p>
                                    <div class="code-block text-xs"><code>curl -X PATCH "http://localhost:8001/api/v1/vulnerabilities/vuln-001/" \
  -H "X-API-Key: your-api-key" \
  -H "Content-Type: application/json" \
  -d '{"status":"in_progress","assigned_to":"security-team"}'</code></div>
                                </div>
                            </details>
                        </div>
                    </div>
                </div>

                <!-- Integration Management -->
                <div class="mb-8">
                    <h3 class="text-xl font-semibold mb-4 text-blue-400">Integration Management</h3>
                    <div class="space-y-4">
                        <!-- GET /integrations -->
                        <div class="glass-effect p-6 rounded-lg endpoint-card">
                            <div class="flex items-start justify-between mb-3">
                                <div>
                                    <h4 class="font-semibold">List Integrations</h4>
                                    <p class="text-sm text-gray-400">GET /api/v1/integrations/</p>
                                </div>
                                <span class="api-method method-get">GET</span>
                            </div>
                            <p class="text-gray-400 mb-3">List all configured integrations with external systems.</p>
                            <details class="group">
                                <summary class="cursor-pointer text-sm text-blue-400 hover:text-blue-300">View Details</summary>
                                <div class="mt-3 pt-3 border-t border-gray-700 text-sm text-gray-300">
                                    <p class="mb-2"><strong>Query Parameters:</strong></p>
                                    <ul class="list-disc list-inside text-xs mb-3 text-gray-400 space-y-1">
                                        <li>status: active, inactive, error</li>
                                        <li>integration_type: ticketing, siem, notification, vulnerability</li>
                                    </ul>
                                    <p class="mb-1"><strong>Example:</strong></p>
                                    <div class="code-block text-xs"><code>curl "http://localhost:8001/api/v1/integrations/?status=active" \
  -H "X-API-Key: your-api-key"</code></div>
                                </div>
                            </details>
                        </div>

                        <!-- POST /integrations/{id}/test -->
                        <div class="glass-effect p-6 rounded-lg endpoint-card">
                            <div class="flex items-start justify-between mb-3">
                                <div>
                                    <h4 class="font-semibold">Test Integration</h4>
                                    <p class="text-sm text-gray-400">POST /api/v1/integrations/{id}/test/</p>
                                </div>
                                <span class="api-method method-post">POST</span>
                            </div>
                            <p class="text-gray-400 mb-3">Test connectivity and authentication with an integration.</p>
                            <details class="group">
                                <summary class="cursor-pointer text-sm text-blue-400 hover:text-blue-300">View Details</summary>
                                <div class="mt-3 pt-3 border-t border-gray-700 text-sm text-gray-300">
                                    <p class="mb-2"><strong>Response:</strong></p>
                                    <div class="code-block text-xs"><code>{"status":"connected","platform":"JIRA","message":"Successfully connected"}</code></div>
                                </div>
                            </details>
                        </div>
                    </div>
                </div>

                <!-- Authentication & Rate Limiting -->
                <div class="glass-effect p-6 rounded-lg mt-8">
                    <h4 class="font-semibold mb-3">Authentication</h4>
                    <p class="text-gray-400 text-sm mb-3">Guardian Service supports two authentication methods:</p>
                    <ul class="list-disc list-inside text-sm text-gray-400 space-y-2">
                        <li><strong>API Key:</strong> Use X-API-Key header with your API key</li>
                        <li><strong>Bearer Token:</strong> Use Authorization: Bearer header with JWT token</li>
                    </ul>
                    <h4 class="font-semibold mt-4 mb-2">Rate Limiting</h4>
                    <p class="text-gray-400 text-sm">
                        <strong>Anonymous:</strong> 100 requests/hour |
                        <strong>API Key:</strong> 5,000 requests/hour |
                        <strong>Bearer Token:</strong> 1,000 requests/hour
                    </p>
                </div>

                <!-- Full Documentation Link -->
                <div class="glass-effect p-6 rounded-lg mt-4 text-center">
                    <p class="text-gray-400 mb-3">For complete Guardian Service API documentation including all endpoints, error codes, and advanced examples:</p>
                    <a href="https://github.com/fabriziosalmi/wildbox/blob/main/docs/api/guardian/endpoints.md" target="_blank" class="inline-block px-4 py-2 bg-blue-600 hover:bg-blue-700 rounded transition">
                        View Full Documentation â†’
                    </a>
                </div>
            </section>

            <section id="agents-api" class="scroll-mt-20">
                <h2 class="text-3xl font-bold mb-6">Agents Service API</h2>
                <p class="text-gray-400 mb-8">AI-powered threat analysis and intelligent enrichment using large language models</p>
                
                <div class="glass-effect p-6 rounded-lg mb-4">
                    <h3 class="text-xl font-semibold mb-4">Service Information</h3>
                    <p class="text-gray-400 text-sm mb-3"><strong>Port:</strong> 8004 | <strong>Base URL:</strong> http://localhost:8004 | <strong>Auth:</strong> Bearer Token (JWT)</p>
                    <p class="text-gray-400 text-sm">The Agents Service uses AI to analyze indicators of compromise (IOCs) and provide comprehensive threat assessments through intelligent agents.</p>
                </div>

                <div class="glass-effect p-6 rounded-lg endpoint-card mb-4">
                    <div class="flex items-center gap-3 mb-3">
                        <span class="api-method method-get">GET</span>
                        <code class="text-blue-400">/health</code>
                    </div>
                    <p class="text-gray-400 text-sm mb-3">Health check endpoint for service monitoring</p>
                    <h4 class="font-semibold mt-4 mb-2">Response Example</h4>
                    <div class="code-block">
                        <code>{
  "status": "healthy",
  "timestamp": "2024-11-07T18:30:00Z",
  "version": "1.0.0",
  "services": {
    "redis": "healthy",
    "celery": "healthy",
    "openai": "configured"
  }
}</code>
                    </div>
                </div>

                <div class="glass-effect p-6 rounded-lg endpoint-card mb-4">
                    <div class="flex items-center gap-3 mb-3">
                        <span class="api-method method-post">POST</span>
                        <code class="text-blue-400">/v1/analyze</code>
                    </div>
                    <p class="text-gray-400 text-sm mb-3">Analyze indicators of compromise using AI-powered threat intelligence</p>
                    <h4 class="font-semibold mt-4 mb-2">Authentication Required</h4>
                    <p class="text-gray-400 text-sm">Bearer Token (JWT) required</p>
                </div>

                <div class="glass-effect p-6 rounded-lg mt-4 text-center">
                    <p class="text-gray-400 mb-3">For complete Agents Service API documentation:</p>
                    <a href="https://github.com/fabriziosalmi/wildbox/blob/main/docs/api/agents/endpoints.md" target="_blank" class="inline-block px-4 py-2 bg-blue-600 hover:bg-blue-700 rounded transition">
                        View Full Documentation
                    </a>
                </div>
            </section>

            <section id="data-api" class="scroll-mt-20">
                <h2 class="text-3xl font-bold mb-6">Data Service API</h2>
                <p class="text-gray-400 mb-8">Security intelligence data aggregation from 50+ threat intelligence sources</p>
                
                <div class="glass-effect p-6 rounded-lg mb-4">
                    <h3 class="text-xl font-semibold mb-4">Service Information</h3>
                    <p class="text-gray-400 text-sm mb-3"><strong>Port:</strong> 8006 | <strong>Base URL:</strong> http://localhost:8006/api/v1 | <strong>Auth:</strong> Optional API Key</p>
                    <p class="text-gray-400 text-sm">Access threat intelligence data, IOCs, and enriched security information from multiple sources.</p>
                </div>

                <div class="glass-effect p-6 rounded-lg endpoint-card mb-4">
                    <div class="flex items-center gap-3 mb-3">
                        <span class="api-method method-get">GET</span>
                        <code class="text-blue-400">/indicators/search</code>
                    </div>
                    <p class="text-gray-400 text-sm mb-3">Search for indicators of compromise in the threat intelligence database</p>
                    <h4 class="font-semibold mt-4 mb-2">Query Parameters</h4>
                    <table class="param-table w-full">
                        <thead>
                            <tr>
                                <th>Parameter</th>
                                <th>Type</th>
                                <th>Description</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td>q</td>
                                <td><span class="param-type">string</span></td>
                                <td class="text-gray-400">Search query (IP, domain, hash, URL)</td>
                            </tr>
                            <tr>
                                <td>type</td>
                                <td><span class="param-type">string</span></td>
                                <td class="text-gray-400">Filter by type: ipv4, domain, md5, sha256</td>
                            </tr>
                            <tr>
                                <td>limit</td>
                                <td><span class="param-type">integer</span></td>
                                <td class="text-gray-400">Number of results (default: 20)</td>
                            </tr>
                        </tbody>
                    </table>
                </div>

                <div class="glass-effect p-6 rounded-lg mt-4 text-center">
                    <p class="text-gray-400 mb-3">For complete Data Service API documentation:</p>
                    <a href="https://github.com/fabriziosalmi/wildbox/blob/main/docs/api/data/endpoints.md" target="_blank" class="inline-block px-4 py-2 bg-blue-600 hover:bg-blue-700 rounded transition">
                        View Full Documentation
                    </a>
                </div>
            </section>

            <section id="tools-api" class="scroll-mt-20">
                <h2 class="text-3xl font-bold mb-6">Tools Service API</h2>
                <p class="text-gray-400 mb-8">Execute 54+ security tools including vulnerability scanners and network analyzers</p>
                
                <div class="glass-effect p-6 rounded-lg mb-4">
                    <h3 class="text-xl font-semibold mb-4">Service Information</h3>
                    <p class="text-gray-400 text-sm mb-3"><strong>Port:</strong> 8013 | <strong>Base URL:</strong> http://localhost:8013/api | <strong>Auth:</strong> API Key Required</p>
                    <p class="text-gray-400 text-sm">Unified interface for security analysis tools across vulnerability scanning, network analysis, and web application testing.</p>
                    <div class="mt-3 text-sm">
                        <span class="px-3 py-1 bg-green-900/30 text-green-400 rounded mr-2">Security Score: 8.5/10</span>
                        <span class="px-3 py-1 bg-blue-900/30 text-blue-400 rounded">0 Vulnerabilities</span>
                    </div>
                </div>

                <div class="glass-effect p-6 rounded-lg endpoint-card mb-4">
                    <div class="flex items-center gap-3 mb-3">
                        <span class="api-method method-get">GET</span>
                        <code class="text-blue-400">/tools</code>
                    </div>
                    <p class="text-gray-400 text-sm mb-3">List all available security tools with filtering options</p>
                    <h4 class="font-semibold mt-4 mb-2">Response Example</h4>
                    <div class="code-block">
                        <code>{
  "count": 54,
  "results": [
    {
      "id": "nessus-001",
      "name": "Nessus Scanner",
      "category": "scanner",
      "version": "10.4.2",
      "status": "active"
    }
  ]
}</code>
                    </div>
                </div>

                <div class="glass-effect p-6 rounded-lg endpoint-card mb-4">
                    <div class="flex items-center gap-3 mb-3">
                        <span class="api-method method-post">POST</span>
                        <code class="text-blue-400">/execute</code>
                    </div>
                    <p class="text-gray-400 text-sm mb-3">Execute security tools with specified parameters</p>
                    <h4 class="font-semibold mt-4 mb-2">Authentication Required</h4>
                    <p class="text-gray-400 text-sm">X-API-Key header required</p>
                </div>

                <div class="glass-effect p-6 rounded-lg mt-4 text-center">
                    <p class="text-gray-400 mb-3">For complete Tools Service API documentation:</p>
                    <a href="https://github.com/fabriziosalmi/wildbox/blob/main/docs/api/tools/endpoints.md" target="_blank" class="inline-block px-4 py-2 bg-blue-600 hover:bg-blue-700 rounded transition">
                        View Full Documentation
                    </a>
                </div>
            </section>

            <section id="responder-api" class="scroll-mt-20">
                <h2 class="text-3xl font-bold mb-6">Responder Service API</h2>
                <p class="text-gray-400 mb-8">SOAR platform for automated incident response and playbook execution</p>
                
                <div class="glass-effect p-6 rounded-lg mb-4">
                    <h3 class="text-xl font-semibold mb-4">Service Information</h3>
                    <p class="text-gray-400 text-sm mb-3"><strong>Port:</strong> 8018 | <strong>Base URL:</strong> http://localhost:8018/api/v1 | <strong>Auth:</strong> Bearer Token (JWT)</p>
                    <p class="text-gray-400 text-sm">Orchestrate incident response workflows, execute playbooks, and manage remediation actions automatically.</p>
                </div>

                <div class="glass-effect p-6 rounded-lg endpoint-card mb-4">
                    <div class="flex items-center gap-3 mb-3">
                        <span class="api-method method-get">GET</span>
                        <code class="text-blue-400">/playbooks</code>
                    </div>
                    <p class="text-gray-400 text-sm mb-3">List all available SOAR playbooks with filtering</p>
                    <h4 class="font-semibold mt-4 mb-2">Query Parameters</h4>
                    <table class="param-table w-full">
                        <thead>
                            <tr>
                                <th>Parameter</th>
                                <th>Type</th>
                                <th>Description</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td>category</td>
                                <td><span class="param-type">string</span></td>
                                <td class="text-gray-400">incident_response, malware, threat_intel</td>
                            </tr>
                            <tr>
                                <td>enabled</td>
                                <td><span class="param-type">boolean</span></td>
                                <td class="text-gray-400">Filter by enabled status</td>
                            </tr>
                        </tbody>
                    </table>
                </div>

                <div class="glass-effect p-6 rounded-lg endpoint-card mb-4">
                    <div class="flex items-center gap-3 mb-3">
                        <span class="api-method method-post">POST</span>
                        <code class="text-blue-400">/playbooks/{id}/execute</code>
                    </div>
                    <p class="text-gray-400 text-sm mb-3">Execute a playbook with specified parameters and context</p>
                    <h4 class="font-semibold mt-4 mb-2">Authentication Required</h4>
                    <p class="text-gray-400 text-sm">Bearer Token (JWT) required</p>
                </div>

                <div class="glass-effect p-6 rounded-lg mt-4 text-center">
                    <p class="text-gray-400 mb-3">For complete Responder Service API documentation:</p>
                    <a href="https://github.com/fabriziosalmi/wildbox/blob/main/docs/api/responder/endpoints.md" target="_blank" class="inline-block px-4 py-2 bg-blue-600 hover:bg-blue-700 rounded transition">
                        View Full Documentation
                    </a>
                </div>
            </section>
        </div>

        <!-- Authentication Info -->
        <div class="mt-20 pt-12 border-t border-gray-800">
            <h2 class="text-2xl font-bold mb-6">Authentication</h2>
            <div class="glass-effect p-6 rounded-lg">
                <p class="text-gray-400 mb-4">All API endpoints require authentication using Bearer tokens in the Authorization header:</p>
                <div class="code-block mb-4">
                    <code>Authorization: Bearer eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9...</code>
                </div>
                <p class="text-gray-400">Obtain a token by logging in via the <code class="bg-gray-800 px-2 py-1 rounded">/auth/login</code> endpoint with your credentials.</p>
            </div>
        </div>

        <!-- Error Handling -->
        <div class="mt-12">
            <h2 class="text-2xl font-bold mb-6">Error Handling</h2>
            <div class="glass-effect p-6 rounded-lg">
                <p class="text-gray-400 mb-4">The API returns standard HTTP status codes. Errors include detailed JSON responses:</p>
                <div class="code-block">
                    <code>{
  "error": "Unauthorized",
  "message": "Invalid or expired token",
  "status": "error",
  "request_id": "req-12345"
}</code>
                </div>
                <p class="text-gray-400 text-sm mt-4">See individual endpoint documentation for specific error codes and handling.</p>
            </div>
        </div>

        <!-- Support -->
        <div class="mt-16 pt-12 border-t border-gray-800 text-center">
            <h2 class="text-2xl font-bold mb-4">Need Help?</h2>
            <p class="text-gray-400 mb-6">Check out our resources for more information:</p>
            <div class="flex flex-col sm:flex-row gap-4 justify-center">
                <a href="docs.html" class="px-6 py-2 bg-blue-600 hover:bg-blue-700 rounded text-sm transition">
                    Documentation Hub
                </a>
                <a href="https://github.com/fabriziosalmi/wildbox/discussions" target="_blank" class="px-6 py-2 border border-blue-600 hover:border-blue-400 rounded text-sm transition">
                    Discussions
                </a>
                <a href="https://github.com/fabriziosalmi/wildbox/issues" target="_blank" class="px-6 py-2 border border-gray-600 hover:border-gray-400 rounded text-sm transition">
                    Report Issues
                </a>
            </div>
        </div>
    </main>

    <!-- Footer -->
    <footer class="border-t border-gray-800 mt-20 py-12 px-4">
        <div class="max-w-6xl mx-auto text-center text-gray-500 text-sm">
            <p>Wildbox API Reference - All endpoints documented with examples and live endpoints</p>
            <p class="mt-2">Last Updated: November 16, 2025 | API Version: v1</p>
        </div>
    </footer>
</body>
</html>
