# Open Security Sensor Configuration for Docker Deployment

# Data Lake Connection
data_lake:
  endpoint: "https://your-security-data-platform.com/api/v1/ingest"
  api_key: "your-api-key-here"
  tls_verify: true
  batch_size: 100
  flush_interval: 30
  timeout: 30
  retry_attempts: 3
  retry_delay: 5

# Telemetry Collection
collection:
  process_events: true
  network_connections: true
  file_monitoring: true
  user_events: true
  system_inventory: true
  log_forwarding: false

# File Integrity Monitoring (Docker-optimized paths)
fim:
  enabled: true
  paths:
    # Host paths (mounted as /host/*)
    - "/host/etc"
    - "/host/bin"
    - "/host/usr/bin"
    - "/host/opt"
  exclude_patterns:
    - "*.tmp"
    - "*.log"
    - "*.cache"
    - "*.pid"
    - "*.lock"
  recursive: true
  max_depth: 10

# Performance Tuning (Docker-optimized)
performance:
  query_interval: 10
  max_memory_mb: 256  # Higher for Docker
  max_cpu_percent: 10  # Slightly higher for containerized environment
  max_queue_size: 2000
  worker_threads: 4

# Logging Configuration
logging:
  level: "INFO"
  file: "/var/log/security-sensor/sensor.log"
  max_size: 10485760  # 10MB
  backup_count: 5
  format: "%(asctime)s - %(name)s - %(levelname)s - %(message)s"

# Network Configuration
network:
  bind_address: "0.0.0.0"  # Listen on all interfaces in container
  bind_port: 8899
  enable_api: true
  api_key: null  # Set to require API key authentication

# Docker-specific osquery configuration
osquery:
  # Use host namespaces for system monitoring
  host_proc_path: "/host/proc"
  host_sys_path: "/host/sys"
  host_etc_path: "/host/etc"
